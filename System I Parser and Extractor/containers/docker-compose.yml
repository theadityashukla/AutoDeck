version: '3.8'

services:
  grobid:
    build:
      context: .
      dockerfile: Dockerfile.arm64
    image: grobid-arm64:latest
    container_name: grobid
    ports:
      - "8070:8070"
      - "8071:8071"
    environment:
      - JAVA_OPTS=-Xmx4g -Djava.library.path=/opt/grobid/grobid-home/lib
    volumes:
      - ./grobid-logs:/opt/grobid/logs
      - ./grobid-home/config:/opt/grobid/grobid-home/config
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8070/api/isalive"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 180s

# Usage:
# Default (ARM64 native): docker-compose up -d